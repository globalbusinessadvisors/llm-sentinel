apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: sentinel

# Common labels applied to all resources
commonLabels:
  app.kubernetes.io/managed-by: kustomize
  app.kubernetes.io/part-of: llm-platform

# Resources to deploy
resources:
  - namespace.yaml
  - serviceaccount.yaml
  - configmap.yaml
  - secret.yaml
  - pvc.yaml
  - deployment.yaml
  - service.yaml
  - hpa.yaml
  - pdb.yaml
  - networkpolicy.yaml
  - servicemonitor.yaml
  - ingress.yaml

# Image configuration
images:
  - name: sentinel
    newName: ghcr.io/llm-devops/sentinel
    newTag: 0.1.0

# ConfigMap generator (alternative to static ConfigMap)
# configMapGenerator:
#   - name: sentinel-config
#     files:
#       - sentinel.yaml=../config/sentinel.yaml

# Secret generator (for development only)
# secretGenerator:
#   - name: sentinel-secrets
#     literals:
#       - influxdb-token=dev-token

# Patches for different environments
patchesStrategicMerge:
  - |-
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: sentinel
      namespace: sentinel
    spec:
      replicas: 3

# Variables for customization
vars:
  - name: SENTINEL_VERSION
    objref:
      kind: Deployment
      name: sentinel
      apiVersion: apps/v1
    fieldref:
      fieldpath: metadata.labels['app.kubernetes.io/version']
